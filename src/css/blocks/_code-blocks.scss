////
/// Highlighted Code Blocks
/// @group blocks
////

@use "../abstracts/mixins";

.code-block {
	position: relative;

	button {
		color: var(--color-yeti);
		position: absolute;
		inset-block-start: var(--size-tiny);
		inset-inline-end: var(--size-gutter);
		font-weight: var(--font-weight-medium);
		z-index: var(--z-index-default);

		&:not(:is(:hover, :focus, :active)) {
			text-decoration-color: transparent;
		}
	}
}

pre[class*="language-"] {
	--flow-space: var(--size-large);
	background-color: light-dark(var(--color-mineshaft), var(--color-thunder));
	border-block-start: var(--size-border-thin) solid var(--border-color, var(--color-raven));
	padding: var(--size-gap) var(--size-gutter) 1em;
	border-radius: 0 0 var(--border-radius, var(--size-border-thin)) var(--border-radius, var(--size-border-thin));
	box-shadow: var(--box-shadow, var(--box-shadow-medium));

	// Labels
	&::before {
		color: var(--color-snowy);
		position: absolute;
		inset-block-start: var(--size-tiny);
		inset-inline-start: var(--size-gutter);
		font-family: var(--font-family-sans);
		font-weight: var(--font-weight-semibold);
	}

	& code {
		color: var(--color-snowy);
		padding: 0;
		line-height: var(--line-height-code);
		white-space: pre-wrap;
	}

	.flow > * + & {
		margin-block: var(--flow-space, var(--size-large));
	}
}

pre.language-none {
	padding-block-start: var(--size-gutter);
}

pre[class*="-bash"]::before {
	content: "Terminal";
	color: var(--color-yeti);
}
pre[class*="-css"]::before {
	content: "CSS";
	color: var(--color-css);
}
pre[class*="-html"]::before {
	content: "HTML";
	color: var(--color-html);
}
pre[class*="-javascript"]::before {
	content: "JavaScript";
	color: var(--color-javascript);
}
pre[class*="-json"]::before {
	content: "JSON";
	color: var(--color-json);
}
pre[class*="-liquid"]::before {
	content: "Liquid";
	color: var(--color-liquid);
}
pre[class*="-markdown"]::before {
	content: "Markdown";
	color: var(--color-snowy);
}
pre:is([class*="-nunjucks"], [class*="-twig"])::before {
	content: "Nunjucks";
	color: var(--color-nunjucks);
}
pre[class*="-php"]::before {
	content: "PHP";
	color: var(--color-php);
}
pre[class*="-scss"]::before {
	content: "SCSS";
	color: var(--color-scss);
}
pre[class*="-webc"]::before {
	content: "WebC";
	color: var(--color-webc);
}
pre[class*="-yaml"]::before {
	content: "YAML";
	color: var(--color-yaml);
}
pre:is([class*="-plaintext"], [class*="-text"])::before {
	content: "Plaintext";
	color: var(--color-yeti);
}

/**
 * a11y-dark theme for JavaScript, CSS, and HTML
 * Based on the okaidia theme: https://github.com/PrismJS/prism/blob/gh-pages/themes/prism-okaidia.css
 * @author ericwbailey
 */

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: #d4d0ab;
}

.token.punctuation {
	color: #fefefe;
}

.token.property,
.token.tag,
.token.constant,
.token.symbol,
.token.deleted {
	color: #ffa07a;
}

.token.boolean,
.token.number {
	color: #00e0e0;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #abe338;
}

.token.operator,
.token.entity,
.token.url,
pre.language-css .token.string,
.style .token.string,
.token.variable {
	color: #00e0e0;
}

.token.atrule,
.token.attr-value,
.token.function {
	color: #eab538;
}

.token.keyword {
	color: #00e0e0;
}

.token.regex,
.token.important {
	color: #eab538;
}

pre[class*="language-diff-"] code {
	padding-inline-start: 3ch;
}

.token.inserted:not(.prefix),
.token.deleted:not(.prefix) {
	display: block;
	padding-inline-start: 3ch;
	margin-inline-start: -3ch;
	position: relative;
}
.token.inserted:not(.prefix) {
	background-color: oklch(from var(--color-conifer) l c h / 0.333);
}
.token.deleted:not(.prefix) {
	background-color: oklch(from var(--color-maple) l c h / 0.333);
	@include mixins.non-selectable;
}

.token.prefix.unchanged,
.token.prefix.inserted,
.token.prefix.deleted {
	position: absolute;
	left: 0;
	padding-inline: 1ch;
	@include mixins.non-selectable;
}

.token.important,
.token.bold {
	font-weight: var(--font-weight-semibold);
}
.token.italic {
	@include mixins.italic;
}

.token.entity {
	cursor: help;
}
