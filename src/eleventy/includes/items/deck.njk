<article class=" [ flow ]{% if hfeed and item.data.mf_root %} [ h-{{ item.data.mf_root }} ] {% endif %}">
	{% if item.data.reply_url %}
		<div class=" [ deck__context ] ">
			{% if item.data.rsvp %}
				<data class=" [ p-rsvp ] " value="{{ item.data.rsvp.value }}" hidden></data>
				{{ item.data.rsvp_string | safe }}
			{% else %}
				<small>in reply to</small>
			{% endif %}
			<a class=" [ h-cite  u-in-reply-to ] " href="{{ item.data.reply_url }}">{{ item.data.reply_title | safe }}</a>
			{% if item.data.reply_author_string and (item.data.reply_author_string | striptags) != item.data.reply_title %}
				<small>by</small> {{ item.data.reply_author_string | safe }}
			{% endif %}
			{% if item.data.rsvp.date | daysUntil == 0 %}
				{# Today #}
				<small>today, from</small>
				<time class=" [ dt-start ] " datetime="{{ item.data.rsvp.date | rfc3339Date }}">{{ item.data.rsvp.date | friendlyTime(false) }}</time>
				–
				<time class=" [ dt-end ] " datetime="{{ item.data.rsvp.end | rfc3339Date }}">{{ item.data.rsvp.end | friendlyTime(true) }}</time>
			{% elif item.data.rsvp.date | epoch > global.now %}
				{# Future #}
				<small>in</small>
				{{ item.data.rsvp.date | daysUntil }} day{{ 's' if (item.data.rsvp.date | daysUntil) > 1 }}
				<small>on</small>
				{% if item.data.rsvp.date | friendlyDate != item.data.rsvp.end | friendlyDate %}
					<time class=" [ dt-start ] " datetime="{{ item.data.rsvp.date | rfc3339Date }}">{{ item.data.rsvp.date | friendlyDate }}</time>
					–
					<time class=" [ dt-end ] " datetime="{{ item.data.rsvp.end | rfc3339Date }}">{{ item.data.rsvp.end | friendlyDate }}</time>
				{% else %}
					<time class=" [ dt-start ] " datetime="{{ item.data.rsvp.date | rfc3339Date }}">{{ item.data.rsvp.date | friendlyDate }}</time>
					<time class=" [ dt-end ] " datetime="{{ item.data.rsvp.end | rfc3339Date }}" hidden></time>
				{% endif %}
			{% elif item.data.rsvp.date | epoch < global.now and item.data.rsvp.end | epoch > global.now %}
				{# Current #}
				<small>from</small>
				<time class=" [ dt-start ] " datetime="{{ item.data.rsvp.date | rfc3339Date }}">{{ item.data.rsvp.date | friendlyTime(false) }}</time>
				–
				<time class=" [ dt-end ] " datetime="{{ item.data.rsvp.end | rfc3339Date }}">{{ item.data.rsvp.end | friendlyTime(true) }}</time>
			{% elif item.data.rsvp.date %}
				{# Past #}
				<small>on</small>
				<time class=" [ dt-start ] " datetime="{{ item.data.rsvp.date | rfc3339Date }}">{{ item.data.rsvp.date | friendlyDate }}</time>
				{% if item.data.rsvp.date | friendlyDate != item.data.rsvp.end | friendlyDate %}
					–
					<time class=" [ dt-end ] " datetime="{{ item.data.rsvp.end | rfc3339Date }}">{{ item.data.rsvp.end | friendlyDate }}</time>
				{% else %}
					<time class=" [ dt-end ] " datetime="{{ item.data.rsvp.end | rfc3339Date }}" hidden></time>
				{% endif %}
			{% endif %}
		</div>
	{% endif %}
	{% if item.data.title or item.data.of_title or item.data.of_title_fallback %}
		<h1 style="view-transition-name: title-{{ item.data.page.fileSlug }};">
			<a class=" [ p-name ] " href="{% if item.data.tags and "clickthrough" in item.data.tags %}{{ item.data.of_url | default(item.url) | safe }}{% else %}{{ item.url | safe }}{% endif %}">
				{% if item.data.emoji %}<c-emoji>{{ item.data.emoji }}</c-emoji> {% endif %}{{ item.data.title | default(item.data.of_title) | default(item.data.of_title_fallback) | striptags(true) | safe }}
			</a>
		</h1>
	{% endif %}
	{% if show_photos %}
		{% include 'photo.njk' %}
	{% endif %}
	{% if item.data.description and item.data.tags and ("page" in item.data.tags or "writing" in item.data.tags) %}
		<p class=" [ p-summary ] {% if item.data.category == 'article' %}[ line-clamp ] {% endif %}">{{ item.data.description | striptags(true) | urlize | safe }}</p>
	{% elif item.data.description and item.data.description_markdown %}
		<p class=" [ p-summary ] {% if item.data.category == 'article' %}[ line-clamp ] {% endif %}">{{ item.data.description | formatAsMarkdown | safe }}</p>
	{% elif item.data.description %}
		<p class=" [ p-summary ] {% if item.data.category == 'article' %}[ line-clamp ] {% endif %}">{{ item.data.description | striptags(true) | maxWords(40, truncate) | urlize | safe }}</p>
	{% elif ['bookmark', 'like', 'note', 'talk'].includes(item.data.category) and item.content  %}
		<p class=" [ p-summary ] ">{{ item.content | striptags(true) | maxWords(40, truncate) | urlize | safe }}</p>
	{% elif item.data.category == 'code' %}
		<p class=" [ p-summary ] ">One of my code demos.</p>
	{% elif item.data.category == 'recipe' %}
		<p class=" [ p-summary ] ">A {{ item.data.categoryProper | default(item.data.category) }}{% if item.data.authors %} by {{ item.data.meta_authors_string | safe }}{% endif %}</p>
	{% endif %}
	{% if item.data.date or item.data.updated or item.data.webmentions or item.data.stargazers %}
		<ul class=" [ cluster ] [ deck__meta ] ">
			{% if item.data.updated %}
				<li>
					<small>updated</small> <a href="{{ item.url }}{{ "#updated" if item.data.updated_text }}" tabindex="-1"><time class=" [ dt-updated ] " datetime="{{ item.data.updated | rfc3339Date }}">{{ item.data.updated | friendlyDateLong | safe }}</time></a>
				</li>
			{% endif %}
			{% if item.data.date %}
				<li>
					<small>published</small> <a class=" [ u-url ] " href="{{ item.url }}"{% if item.data.title or item.data.of_title %} tabindex="-1"{% endif %}><time class=" [ dt-published ] " datetime="{{ item.data.date | rfc3339Date }}">{{ item.data.date | friendlyDateLong | safe }}</time></a>
				</li>
			{% endif %}
			{% if (item.data.show_webmentions and item.data.webmentions.length) or item.data.stargazers %}
				{%- set bookmarks = item.data.webmentions | getWebmentionsByTypes(['bookmark-of']) -%}
				{%- set likes = item.data.webmentions | getWebmentionsByTypes(['like-of']) -%}
				{%- set reposts = item.data.webmentions | getWebmentionsByTypes(['repost-of']) -%}
				{%- set links = item.data.webmentions | getAllLinks -%}
				{%- set reactions = bookmarks.concat(likes).concat(reposts).concat(links) -%}
				{%- set replies = item.data.webmentions | getAllReplies -%}
				{%- set stargazers = item.data.stargazers | default(0) -%}
				{%- set responsesLength = reactions.length + replies.length + stargazers -%}
				<li>
					<a href="{{ item.url }}#respond" title="Jump to responses for this {{ item.data.categoryProper }}">{{ responsesLength }} {% if stargazers == responsesLength %}stargazer{% else %}response{% endif %}{{ 's' if responsesLength > 1 }} <span class="hidden">to this {{ item.data.categoryProper | default(item.data.category) | default('page') }}</span></a>
				</li>
			{% endif %}
		</ul>
	{% endif %}
	{% if item.data.mf_property and item.data.of_url %}
		<data class=" [ u-{{ item.data.mf_property }} ] " value="{{ item.data.of_url }}" hidden></data>
	{% endif %}
	{% if item.data.category %}
		<data class=" [ u-category ] " value="/{{ item.data.categoryPlural | default(item.data.category) }}/" hidden>{{ item.data.category }}</data>
	{% endif %}
	<data class=" [ u-author ] " value="/" hidden></data>
</article>
